from ModelPredictor import ModelPredictor
from ModelTrainer import ModelTrainer

# –≠—Ç–æ—Ç —Ñ–∞–π–ª —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω –≤ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ü–µ–ª—è—Ö, –≥–ª–∞–≤–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω —Å–ª–∏—à–∫–æ–º —Ç—è–∂–µ–ª—ã–π –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞,
# –ø–æ—Å–ª–µ –æ—Ç–ª–∞—Ç–∫–∏ –±–ª–æ–∫–∏ –±—É–¥—É—Ç –ø–æ–ø–∞–¥–∞—Ç—å –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª
if __name__ == "__main__":
    trainer = ModelTrainer(
        data_path = '/Users/papaskakun/PycharmProjects/preHFT/dataset_XGB.parquet',
        model_output_path = 'models/model_xgb.pkl',
        target_col = 'target_300_50bp'
    )
    # –ù–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ (–¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —Ç–µ–º, —á—Ç–æ –¥–æ–±–∞–≤–ª—è–ª—Å—è –≤ FeatureBuilder)
    # target_col = 'target_300_50bp' –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è target_shift=300, threshold=0.005
    # trainer.run()

    # –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–ª–∞—Å—Å–∞ ModelPredictor
    # ‚ö†Ô∏è –ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å, –æ–±—É—á–µ–Ω–Ω—É—é –Ω–∞ BTCUSDT, –¥–ª—è ETHUSDT:
    # 	1.	–ü–æ–≤–µ–¥–µ–Ω–∏–µ —Ä—ã–Ω–∫–∞ —Ä–∞–∑–Ω–æ–µ
    # 	‚Ä¢	BTC –∏ ETH ‚Äî —ç—Ç–æ —Ä–∞–∑–Ω—ã–µ –∞–∫—Ç–∏–≤—ã —Å —Ä–∞–∑–Ω–æ–π –¥–∏–Ω–∞–º–∏–∫–æ–π, –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å—é, –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å—é –∏ —Ä–µ–∞–∫—Ü–∏–µ–π –Ω–∞ –Ω–æ–≤–æ—Å—Ç–∏.
    # 	‚Ä¢	–î–∞–∂–µ –µ—Å–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–∞–µ—Ç (bid_price, ask_volume, –∏ —Ç.–ø.), –∑–Ω–∞—á–µ–Ω–∏—è –∏ –∏—Ö –∑–Ω–∞—á–∏–º–æ—Å—Ç—å –¥–ª—è –º–æ–¥–µ–ª–∏ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è.
    # 	2.	–ú–æ–¥–µ–ª—å —É—á–∏—Ç—Å—è –Ω–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–∞—Ö BTCUSDT
    # 	‚Ä¢	–ú–æ–¥–µ–ª—å ‚Äú–∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç‚Äù, –∫–∞–∫–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è –≤ —Å—Ç–∞–∫–∞–Ω–µ, —Ç—Ä–µ–π–¥–∞—Ö –∏ –æ–Ω—á–µ–π–Ω –º–µ—Ç—Ä–∏–∫–∞—Ö –ø—Ä–∏–≤–æ–¥—è—Ç –∫ —Ä–æ—Å—Ç—É/–ø–∞–¥–µ–Ω–∏—é BTC.
    # 	‚Ä¢	ETH –º–æ–∂–µ—Ç —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –ø–æ-–¥—Ä—É–≥–æ–º—É –¥–∞–∂–µ –ø—Ä–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö.
    # 	3.	Feature distribution shift
    # 	‚Ä¢	–ü—Ä–∏–∑–Ω–∞–∫–∏ (features), —Ç–∞–∫–∏–µ –∫–∞–∫ spread, imbalance, volume spikes, –±—É–¥—É—Ç –∏–º–µ—Ç—å –¥—Ä—É–≥–∏–µ –º–∞—Å—à—Ç–∞–±—ã.
    # 	‚Ä¢	–≠—Ç–æ –Ω–∞—Ä—É—à–∞–µ—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ ‚Äî —á—Ç–æ –≤—Ö–æ–¥–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å—Ç–∞–±–∏–ª—å–Ω–æ.

    # ‚úÖ –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
    #
    # üëâ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ BTCUSDT, –Ω–æ –Ω–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–¥–µ–ª—å –Ω–µ –≤–∏–¥–µ–ª–∞
    #
    # –≠—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è out-of-sample —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ. –°–∞–º—ã–π –Ω–∞–¥—ë–∂–Ω—ã–π –∏ —á–µ—Å—Ç–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–æ–Ω—è—Ç—å, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –º–æ–¥–µ–ª—å.
    # 	‚Ä¢	–ò—Å–ø–æ–ª—å–∑—É–π –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ —Ç–æ–π –¥–∞—Ç—ã, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å –æ–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞.
    # 	‚Ä¢	–ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –º–æ–¥–µ–ª—å —É—á–∏–ª–∞—Å—å –Ω–∞ 2023-01-01 –¥–æ 2024-12-31, –±–µ—Ä–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞ 2025 –≥–æ–¥.

    # üß™ –ö–æ–≥–¥–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω—É –º–æ–¥–µ–ª—å –Ω–∞ –¥—Ä—É–≥–∏–µ –∞–∫—Ç–∏–≤—ã?
    #
    # –¢–æ–ª—å–∫–æ –µ—Å–ª–∏:
    # 	‚Ä¢	–¢—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –æ–±—É—á–∞–µ—à—å multi-asset –º–æ–¥–µ–ª—å, –≥–¥–µ –æ–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç BTC, ETH, SOL –∏ —Ç.–ø.
    # 	‚Ä¢	–õ–∏–±–æ –º–æ–¥–µ–ª—å –≤–∫–ª—é—á–∞–µ—Ç —Ñ–ª–∞–≥ –∞–∫—Ç–∏–≤–∞ –∫–∞–∫ –ø—Ä–∏–∑–Ω–∞–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, asset_type=BTC –∏–ª–∏ ETH).
    # 	‚Ä¢	–ò–ª–∏ —Ç—ã –ø—Ä–∏–º–µ–Ω—è–µ—à—å transfer learning, fine-tuning –∏ domain adaptation ‚Äî –Ω–æ —ç—Ç–æ —É–∂–µ –¥—Ä—É–≥–∞—è –∏—Å—Ç–æ—Ä–∏—è.

    model_predictor = ModelPredictor(
        model_path='models/model_xgb.pkl',  # –ø—É—Ç—å –∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
        data_path='data/test_data.parquet',  # –ø—É—Ç—å –∫ –Ω–æ–≤—ã–º –¥–∞–Ω–Ω—ã–º –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
        target_col='target_300_50bp'  # –Ω–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
    )

    model_predictor.run()




